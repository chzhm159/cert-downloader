<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Cert-downloader : (Apple) SSL Certificate downloader">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Cert-downloader</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/evi-snowm/cert-downloader">View on GitHub</a>

          <h1 id="project_title">Cert-downloader</h1>
          <h2 id="project_tagline">(Apple) SSL Certificate downloader</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/evi-snowm/cert-downloader/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/evi-snowm/cert-downloader/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="cert-downloader" class="anchor" href="#cert-downloader" aria-hidden="true"><span class="octicon octicon-link"></span></a>cert-downloader</h1>

<p><a href="https://travis-ci.org/evi-snowm/cert-downloader"><img src="https://travis-ci.org/evi-snowm/cert-downloader.svg?branch=develop" alt="Build Status"></a></p>

<p>This is a helper module that allows you to download an SSL certificate, by default that of Apple Inc..</p>
<p>Offered functionality:</p>

<ul>
<li>Download certificate and store locally.</li>
<li>Convert certificate to PEM format.</li>
<li>Validate a file against the certificate.</li>
</ul>

<p><strong>NOTE</strong> OpenSSL or compatible must be installed on your system if you wish to use certificates in the PEM format. Without this tool, only the download function will work.</p>

<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>
This module has been <a href="https://www.npmjs.com/package/cert-downloader">published</a>, so the easiest method to install the module is via NPM.
<div class="highlight highlight-sh"><pre>$ npm install cert-downloader</pre></div>

<h2>
<a id="update" class="anchor" href="#update" aria-hidden="true"><span class="octicon octicon-link"></span></a>Update</h2>
<p>If your project already depends on this module just should consider updating to version 0.1.0. This version is a rewrite to make the code clearer
    and more maintainable in the future, but it is purposefully compatible with the previouse release 0.0.4,
    so upgrading should be as painless as possible. Just update your package.json to point to 0.1.0 or 0.1.x and npm update.</p>

<h3>Changes</h3>
<p>
    <ul>
        <li>Rewrote code into own style</li>
        <li>Changed default cache location from 'current' folder to your systems 'temp' folder.</li>
    </ul>
</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<div class="highlight highlight-js">
    <pre><span class="pl-k">var</span> CertDownloader <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>cert-downloader<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> certDl <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">CertDownloader</span>();

<span class="pl-c">// download and save in default (cache) location</span>
certDl.cert(<span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">certificatePath</span>) {
    <span class="pl-k">if</span>(error) {
        <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>Error <span class="pl-pds">'</span></span> <span class="pl-k">+</span> error);
    } <span class="pl-k">else</span> {
        <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Certificate downloaded to <span class="pl-pds">'</span></span> <span class="pl-k">+</span> certificatePath);
        <span class="pl-c">// /nodeproject/certificate/AppleIncRootCertificate.cer</span>
    }
});

<span class="pl-c">// download and convert to PEM (will use cached cer file)</span>
certDl.pem(<span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">certificatePath</span>) {
    <span class="pl-k">if</span>(error) {
        <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>Error <span class="pl-pds">'</span></span> <span class="pl-k">+</span> error);
    } <span class="pl-k">else</span> {
        <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Certificate downloaded to <span class="pl-pds">'</span></span> <span class="pl-k">+</span> certificatePath);
        <span class="pl-c">// /nodeproject/certificate/AppleIncRootCertificate.pem</span>
    }
});

<span class="pl-c">// verifiy an existing file against the certificate</span>
<span class="pl-c">// (will download and convert if required)</span>
<span class="pl-k">var</span> file <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>/nodeproject/certicate/file-to-verify<span class="pl-pds">'</span></span>;
certDl.verify(file, <span class="pl-k">function</span>(<span class="pl-smi">error</span>, <span class="pl-smi">output</span>) {
    <span class="pl-k">if</span>(error){
      <span class="pl-k">return</span> callback(<span class="pl-s"><span class="pl-pds">'</span>File verification failed: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> error);
    }
    <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Verified output: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> output);
});</pre>
</div>

<h2>
<a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<h3>CertDownloader([options])</h3>
<p>Construct a new CertDownloader.</p>
<p>You will always need to call this first. `options` Overrides one or several defaults and should be in JSON format with any of the following options:</p>
<ul>
    <li>`certName`: name of the certificate (default is <em>AppleIncRootCertificate.cer</em>)</li>
    <li> `url`     : URL to download the certificate from (default is <em><a href="http://www.apple.com/appleca/AppleIncRootCertificate.cer">http://www.apple.com/appleca/AppleIncRootCertificate.cer</a></em>)</li>
    <li> `cache`   : path to cache location (a.k.a. where to keep the certificates locally, by default this is the operating system's default directory for temp files)</li>
</ul>
<div class="highlight highlight-js">
    <pre><span class="pl-k">var</span> CertDownloader <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>cert-downloader<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> certDl <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">CertDownloader</span>();</pre>
</div>

<h3>cert(callback)</h3>
<p>Retrieve the certificate.</p>
<p>Attempts to download a missing certificate and returns the path to said certificate if available (either cached or downloaded). The callback gets two arguments (err, path), where path is a string to the location of the certificate.</p>
<div class="highlight highlight-js">
    <pre>certDl.cert(<span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">certificatePath</span>) {
    <span class="pl-k">if</span>(error) {
        <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>Error <span class="pl-pds">'</span></span> <span class="pl-k">+</span> error);
    } <span class="pl-k">else</span> {
        <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Certificate downloaded to <span class="pl-pds">'</span></span> <span class="pl-k">+</span> certificatePath);
    }
});</pre></div>

<h3>pem(callback)</h3>
<p>Retrieve the certificate in PEM format.</p>
<p>Attempts to download and convert a missing certificate and returns the path to said certificate if available (either cached or converted). The callback gets two arguments (err, path), where path is a string to the location of the certificate.</p>
<div class="highlight highlight-js">
    <pre>certDl.pem(<span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">certificatePath</span>) {
    <span class="pl-k">if</span>(error) {
        <span class="pl-en">console</span><span class="pl-c1">.error</span>(<span class="pl-s"><span class="pl-pds">'</span>Error <span class="pl-pds">'</span></span> <span class="pl-k">+</span> error);
    } <span class="pl-k">else</span> {
        <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Certificate downloaded to <span class="pl-pds">'</span></span> <span class="pl-k">+</span> certificatePath);
    }
});</pem></div>

<h3>verify(file, callback)</h3>
<p>Verifies a file against the certificate.</p>
<p>Attempts to download and convert a missing certificate and returns the content of the file if successfully verified. The callback gets two arguments (err, output), where output is the content of the file if successfully verified.</p>
<div class="highlight highlight-js"><pre>
<span class="pl-k">var</span> file <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>/nodeproject/cert/file-to-verify<span class="pl-pds">'</span></span>;
certDl.verify(file, <span class="pl-k">function</span>(<span class="pl-smi">error</span>, <span class="pl-smi">output</span>) {
    <span class="pl-k">if</span>(error){
      <span class="pl-k">return</span> callback(<span class="pl-s"><span class="pl-pds">'</span>File verification failed: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> error);
    }
    <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>Verified output: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> output);
});</pre>
</div>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>Copyright © 2015 Patrick Londema</p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Cert-downloader maintained by <a href="https://github.com/evi-snowm">evi-snowm</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
